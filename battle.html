<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dance-Offs: Battle</title>
  <link rel="stylesheet" href="style2.css?v=17">
</head>

<body>

  <!-- Navigation -->
  <div class="navbar">
    <a href="index.html">Home</a>
    <a href="dancers.html">Dancers</a>
    <a href="battle.html" class="active">Battle</a>
    <a href="djs.html">DJs</a>
    <a href="merch.html">Merch</a>
  </div>

  <!-- Two-column battle layout -->
  <div class="battle-wrapper">

    <!-- LEFT SIDE -->
    <div class="battle-column">

      <div class="input-box">
        <input id="leftInput" type="text" placeholder="Left YouTube URL">
        <button type="button" onclick="loadLeft()">Load Left</button>
      </div>

      <div class="video-box">
        <div class="video-label">Dancer Left</div>
        <iframe
          id="leftVid"
          src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=1&playsinline=1"
          allow="autoplay; encrypted-media"
          allowfullscreen>
        </iframe>
      </div>

    </div>

    <!-- RIGHT SIDE -->
    <div class="battle-column">

      <div class="input-box">
        <input id="rightInput" type="text" placeholder="Right YouTube URL">
        <button type="button" onclick="loadRight()">Load Right</button>
      </div>

      <div class="video-box">
        <div class="video-label">Dancer Right</div>
        <iframe
          id="rightVid"
          src="https://www.youtube.com/embed/3JZ_D3ELwOQ?autoplay=1&mute=1&playsinline=1"
          allow="autoplay; encrypted-media"
          allowfullscreen>
        </iframe>
      </div>

    </div>

  </div>

  <!-- Footer -->
  <div class="footer">
    © 2026 Dance-Offs — Built by Baz
  </div>

  <!-- Script -->
  <script>
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbyfiIlExm-_OC9ULZHPaNkIaJ7RWKRDbkTSplu6_8A37cEy5Ph1YAdjF58dwF3uEntOdQ/exec";

    function extractVideoID(raw) {
      if (!raw) return null;
      const url = raw.trim();

      let match;

      match = url.match(/[?&]v=([^&#]+)/i);
      if (match) return match[1];

      match = url.match(/youtu\.be\/([^?&#]+)/i);
      if (match) return match[1];

      match = url.match(/shorts\/([^?&#]+)/i);
      if (match) return match[1];

      match = url.match(/embed\/([^?&#]+)/i);
      if (match) return match[1];

      match = url.match(/youtube\.com\/.*\/([^?&#]+)/i);
      if (match) return match[1];

      return null;
    }

    function logToSheet(side, url) {
      const fullURL =
        SHEET_URL +
        "?dancer=" + encodeURIComponent(side) +
        "&url=" + encodeURIComponent(url);

      fetch(fullURL, { method: "GET", mode: "no-cors" })
        .catch(() => {});
    }

    function loadLeft() {
      const url = document.getElementById("leftInput").value;
      const id = extractVideoID(url);

      if (!id) {
        alert("Invalid YouTube URL for the left side.");
        return;
      }

      const embedURL =
        "https://www.youtube.com/embed/" +
        id +
        "?autoplay=1&mute=1&playsinline=1";

      document.getElementById("leftVid").src = embedURL;

      setTimeout(() => logToSheet("Left", url), 300);
    }

    function loadRight() {
      const url = document.getElementById("rightInput").value;
      const id = extractVideoID(url);

      if (!id) {
        alert("Invalid YouTube URL for the right side.");
        return;
      }

      const embedURL =
        "https://www.youtube.com/embed/" +
        id +
        "?autoplay=1&mute=1&playsinline=1";

      document.getElementById("rightVid").src = embedURL;

      setTimeout(() => logToSheet("Right", url), 300);
    }
  </script>

</body>
</html>
