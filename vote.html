<html lang="en">
<head>
  <meta charset="UTF-8">

  <title>Dance-Offs: Vote</title>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@300;400;600&display=swap" rel="stylesheet"></script>

  <style> {
      position !important;
      background: rgba(0,0,0,0.9);
      color: #fff;
           align-items;
      font-size: 28px;
      font-family: 'Bangers', cursive;
     : 999999 !importanter {
      position: absolute !important !important;
      !important;
      auto !important;
    }
  </style>

  <div id="loadingOverlay"> wait</div>

  <nav class="navbar">
    <a href="index.html">Dancers</a>
    <a href="https://upload.dance-offs.com/uploads/djs.html">DJs</a>
    <a href="vote.html" class="active">Prizes</a>
    <a href="shop.html">Shop</a>
  </nav>

  <p id="countdownTimer" style="text-align:center; margin-top:15px; font-size:20px;"></p>

  <main class="page-container">
        <div id="championVideo" class="video-slot"></div>
        <button class="vote-button" id="voteChampion" onclick="vote('champion')" disabled>
          Vote Champion
        </button> <!-- PAYPAL -->
      <div class="vote-column">Vote for £1.50</h2>
        <p style="color:#ccc; margin-bottom:10px;"> your vote.</p>


          <div id="paypal-button-container">
      </div>

      <!-- CHALLENGER -->
        <div id="challengerVideo" class="video-slot">
      </div>

    </div>

    <!-- PROGRESS -->
    <section id="voteProgressSection" style="margin-top:30px; text-align:center;">

      <h3 style="font-family:'Bangers', cursive; font-size:26px; margin-bottom:15px;">
      </h3>

      Votes: 0
        </div>

       </div>
        </div> Votes: 0
        <div class="progress-wrapper" style="margin-top:6px;">
      </div>

     Remaining votes:

    <!-- NOW PLAYING -->
    <div style="margin-top:40px; text-align:center;">
        Now Playing <p id="djTrackName" style="color:#ccc; margin-bottom:10px;"></p>

      <!-- MP3: not muted -->
      <audio id="djPlayer" controls autoplay playsinline style="width:100%; max-width:500px;">
    © 2026 Dance-Offs. All rights
    <a href="https://dance-offs.com/tnc.html" style="color:#ffcc00; text-decoration:underline;">
      Terms & Conditions

  <script>
    const endpoint =
      "https://script/s/AKfycbxUMisR1LesPSJAVLofrAvZqqSY5S0rncj/exec";

    let currentTransaction = null;

    let;
    let challenger.Buttons({
     , actions) =>
       " } }]
        }),

 =>
        actions.order.capture().          current.id;

          document.getElementById(" = false;
          document.getElementById("voteChallenger").disabled = false;

          documentList.add("enabledvoteChallenger").classList.add("enabled");
        })
    }).render("#paypal");

    /* YOUTUBE ID EXTRACTOR */
ID(url) {
      if (!url) return null = [
        /short /youtu\.be\/([^ /v=([^?&/]+)/,
        /embed\/ /youtube\.com\/watch\/([^?&/]+) patterns) {
        return null;
    }

    /* EMBED + muted immediately */
    functionCallback) {
      const iframe = documentiframe");
      iframe.className = "battle-frame";

      //1 + enablejsapi=3 audio
      iframehttps://www.youtube.com/embed/${id}?autoplay=1&mute=1&loop=1&playlist=1&enablejsapi=1`;
      iframe.allow = "autoplay; encrypted-media";

      iframe        try {
         .postMessage(
            JSON.stringify({ event: "command "*"
          );
e) {
          console failed:", e);
       LoadCallback();
 blocker = documentdiv");
      blocker.className = "block.createElement(" container.style.inset = "0";
     Child(iframe);
           return container() {
      const=getstate").then + "?mode=getdancers());

      current[state.championIndex];
      challenger.challengerIndex];

      let videos = false;

      function hideOverlayoverlayHidden) {
          overlayHidden = true;
         ById("loadingOverlay").style.display = "none";
        function checkDone() {
        videosLoaded++;
        >= 2) hideOverlayOverlay, 3000);

ID = extractID(ch const champEmbed = embed(champID, checkDone);
     ById("championVideoampEmbed);

      const challID =enger.url);
     , checkDone);
     ById("challengerVideo").appendChild }

    /* LOAD DJ TRACK – click‑to‑in */
    async=getdjs").then(r.length === 0) return;

      const last - 1];
      const.getElementById("djPlayer");

     ").innerText =
       ";

      player.src = last.mp3url;
      player.volume = 0;

      function          let vol fade = setInterval(() => {
           1, vol + 0.05);
.volume = vol;
                     }, 80);
        }).catch(err => {
          console.log("Audio play blocked:", err);
        });

.removeEventListener: true });
    }

 COUNTS – shared function loadVoteCounts() {
      if (!currentBattle const data = await fetch(
        endpointestate&battleID=" + currentBattle => r.json());

ElementById("champText =
        "Champion Votes: " + data.championinnerText =
        "Challenger Votesenger.used;

      document.getElementText").innerText =
        "Remaining.maxVotes || 200.getElementById(".width =
        / max * 100) + "%challengerBar").style.width =
        (data.challenger) + "%";
    }

 function vote(side) {
      if (!currentTransactionID) {
 voting.");
             const dancer.dancer;
      const dancerURL  = side === "champion" ?Data = new URLSearchData.append("mode", "vote");
     URL", dancerURL);
      formData.appendID);
      formData.append("BattleIDID);
      formData.append("side", side);

      fetch(endpoint, { method: "POST", body: formData        .then(text => {
          if (text && text.indexOf("Voting closed") !== -1) {
            alert("Voting is now closed for this battle.");
            }
          window.location.href =
ID + "&tx=" + currentTransactionID;
        });
    }

    /* COUNTDOWN */
    function loadCountdown() {
      fetch(endpoint + "?mode=getstate")
        .then(r => r.json(state => {
          const lastUpdated = new Date(state.lastUpdated);
          const nextResetUpdated.getTime() + 7 * 24 * 60 * 60 * 1000);

          Date();
           Reset - now;

           .getElementById("countdownTimer").innerText =
                "New battle dropping soon…";
              return;
            }

            const);
            const((diff / 3600000 const mins = Math00) % 60);
            document.getElementById("countdownTimer `Next battle inTimer();
          });
    }

    /* await loadDJTrack();
      loadCountdown();

      setTimeout 1000);
      set };
  </script>

