<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dance-Offs: Prizes</title>

  <link rel="stylesheet" href="style2.css?v=1050">
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>

  <!-- NAVIGATION -->
  <nav class="navbar">
    <a href="index.html">Home</a>
    <div class="dropdown"><a href="dancers.html">Dancers</a></div>
    <div class="dropdown"><a href="djs.html">DJs</a></div>
    <a href="vote.html">Vote</a>
    <a href="prizes.html" class="active">Prizes</a>
    <div class="dropdown"><a href="shop.html">Shop</a></div>
  </nav>

  <!-- SUPER COMPACT SECTION -->
  <div style="position:relative; text-align:center; padding:20px; min-height:500px;">

    <!-- BACKGROUND IMAGES -->
    <div style="position:absolute; top:0; left:0; width:100%; height:100%; overflow:hidden; opacity:0.25; z-index:-1;">
      <img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800" style="width:50%; float:left;">
      <img src="https://images.unsplash.com/photo-1519677100203-a0e668c92439?w=800" style="width:50%; float:left;">
      <img src="https://images.unsplash.com/photo-1581349481268-1c1f908db8b2?w=800" style="width:50%; float:left;">
      <img src="https://images.unsplash.com/photo-1508609349937-5ec4ae374ebf?w=800" style="width:50%; float:left;">
    </div>

    <!-- FOREGROUND CONTENT -->
    <div style="position:relative; z-index:2; max-width:350px; margin:0 auto;">

      <h1 class="prize-title" style="margin-bottom:10px;">Weekly Prizes</h1>

      <p style="color:white; font-size:16px; margin-bottom:15px;">
        Enter your name and email address and buy votes to win the prize.
      </p>

      <!-- FORM -->
      <input type="text" id="userName" placeholder="Your Name" 
             style="width:100%; padding:10px; margin-bottom:8px; border-radius:6px;">

      <input type="email" id="userEmail" placeholder="Your Email Address" 
             style="width:100%; padding:10px; margin-bottom:8px; border-radius:6px;">

      <button onclick="submitDetails()" 
              style="width:100%; padding:10px; font-weight:bold; border-radius:6px;">
        Continue
      </button>

      <!-- PAYMENT SECTION -->
      <div id="paymentSection" style="display:none; margin-top:15px;">
        <h3 style="color:white; margin-bottom:10px;">Buy Votes (£1)</h3>
        <div id="paypal-button-container"></div>
      </div>

    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    © 2026 Dance-Offs — Built by Baz
  </footer>

  <!-- PAYPAL SDK -->
  <script src="https://www.paypal.com/sdk/js?currency=GBP&client-id=YOUR_CLIENT_ID"></script>

  <script>
    const endpoint =
      "https://script.google.com/macros/s/AKfycbwuOUEAuAE4CfauFw9Xxv3BJenwCUaUNakrb7DTeTjJLZMK8S1hCXbcLRBHCY3FoFZD_g/exec";

    let savedName = "";
    let savedEmail = "";

    function submitDetails() {
      const name = document.getElementById("userName").value.trim();
      const email = document.getElementById("userEmail").value.trim();

      if (!name || !email) {
        alert("Please enter both your name and email.");
        return;
      }

      savedName = name;
      savedEmail = email;

      fetch(
        endpoint +
        "?mode=saveuser" +
        "&name=" + encodeURIComponent(name) +
        "&email=" + encodeURIComponent(email)
      )
      .then(r => r.text())
      .then(t => {
        document.getElementById("paymentSection").style.display = "block";
        alert("Details saved — now complete payment to buy votes.");
      })
      .catch(err => {
        console.error("Save error:", err);
        alert("There was a problem saving your details.");
      });
    }

    // PAYPAL BUTTON
    paypal.Buttons({
      createOrder: function(data, actions) {
        return actions.order.create({
          purchase_units: [{
            amount: { value: "1.00" }
          }]
        });
      },

      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {

          // Log payment to Google Sheet
          fetch(
            endpoint +
            "?mode=payment" +
            "&name=" + encodeURIComponent(savedName) +
            "&email=" + encodeURIComponent(savedEmail) +
            "&amount=1.00"
          )
          .catch(err => console.error("Payment log error:", err));

          alert("Payment received — your votes are now active.");
        });
      }

    }).render("#paypal-button-container");
  </script>

</body>
</html>
