<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dance-Offs: DJs</title>
  <link rel="stylesheet" href="style.css?v=1">
</head>

<body>

  <!-- Navigation -->
  <div class="navbar">
    <a href="index.html">Home</a>
    <a href="dancers.html">Dancers</a>
    <a href="battle.html">Battle</a>
    <a href="djs.html" class="active">DJs</a>
    <a href="merch.html">Merch</a>
  </div>

  <h1 style="text-align:center; margin-top:20px; color:white;">DJ Mix Battle</h1>

  <div class="battle-wrapper">

    <!-- LEFT DJ -->
    <div class="battle-column">

      <div class="input-box">
        <input id="leftDJInput" type="text" placeholder="Left DJ SoundCloud URL">
        <button type="button" onclick="loadLeftDJ()">Load Left Mix</button>
      </div>

      <div class="video-box">
        <div class="video-label">DJ Left</div>
        <iframe
          id="leftDJFrame"
          src=""
          allow="autoplay"
          allowfullscreen>
        </iframe>
      </div>

    </div>

    <!-- RIGHT DJ -->
    <div class="battle-column">

      <div class="input-box">
        <input id="rightDJInput" type="text" placeholder="Right DJ SoundCloud URL">
        <button type="button" onclick="loadRightDJ()">Load Right Mix</button>
      </div>

      <div class="video-box">
        <div class="video-label">DJ Right</div>
        <iframe
          id="rightDJFrame"
          src=""
          allow="autoplay"
          allowfullscreen>
        </iframe>
      </div>

    </div>

  </div>

  <div class="footer">
    © 2026 Dance-Offs — Built by Baz
  </div>

  <script>
    // Your real Google Apps Script endpoint
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbyfiIlExm-_OC9ULZHPaNkIaJ7RWKRDbkTSplu6_8A37cEy5Ph1YAdjF58dwF3uEntOdQ/exec";

    // Build SoundCloud embed URL
    function buildSoundCloudEmbed(url) {
      if (!url || !url.includes("soundcloud.com")) return null;

      return (
        "https://w.soundcloud.com/player/?url=" +
        encodeURIComponent(url) +
        "&auto_play=true&visual=true"
      );
    }

    // Log to your Google Sheet
    function logToSheet(side, url) {
      const fullURL =
        SHEET_URL +
        "?dancer=" + encodeURIComponent(side) +
        "&soundcloud=" + encodeURIComponent(url);

      fetch(fullURL, { method: "GET", mode: "no-cors" })
        .catch(() => {});
    }

    function loadLeftDJ() {
      const url = document.getElementById("leftDJInput").value;
      const embed = buildSoundCloudEmbed(url);

      if (!embed) {
        alert("Please enter a valid SoundCloud URL for the left DJ.");
        return;
      }

      document.getElementById("leftDJFrame").src = embed;

      // Log after load
      setTimeout(() => logToSheet("DJ Left", url), 200);
    }

    function loadRightDJ() {
      const url = document.getElementById("rightDJInput").value;
      const embed = buildSoundCloudEmbed(url);

      if (!embed) {
        alert("Please enter a valid SoundCloud URL for the right DJ.");
        return;
      }

      document.getElementById("rightDJFrame").src = embed;

      // Log after load
      setTimeout(() => logToSheet("DJ Right", url), 200);
    }
  </script>

</body>
</html>
